{% extends "base.html" %}

{% block title %}VMware vSphere Reporter - Mit vCenter verbinden{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8 col-lg-6">
        <div class="card shadow">
            <div class="card-header">
                <h4 class="mb-0">Mit vCenter verbinden</h4>
            </div>
            <div class="card-body">
                {% if error %}
                <div class="alert alert-danger" role="alert">
                    <i class="fas fa-exclamation-triangle me-2"></i>{{ error }}
                </div>
                {% endif %}
                
                <form method="post" action="{{ url_for('connect') }}">
                    <div class="mb-3">
                        <label for="server" class="form-label">vCenter Server</label>
                        <div class="input-group">
                            <span class="input-group-text"><i class="fas fa-server"></i></span>
                            <input type="text" class="form-control" id="server" name="server" placeholder="vcenter.example.com" required>
                        </div>
                        <div class="form-text">Hostname oder IP-Adresse des vCenter-Servers</div>
                    </div>
                    
                    <div class="mb-3">
                        <label for="username" class="form-label">Benutzername</label>
                        <div class="input-group">
                            <span class="input-group-text"><i class="fas fa-user"></i></span>
                            <input type="text" class="form-control" id="username" name="username" placeholder="administrator@vsphere.local" required>
                        </div>
                        <div class="form-text">vCenter Benutzername (z.B. administrator@vsphere.local)</div>
                    </div>
                    
                    <div class="mb-3">
                        <label for="password" class="form-label">Passwort</label>
                        <div class="input-group">
                            <span class="input-group-text"><i class="fas fa-key"></i></span>
                            <input type="password" class="form-control" id="password" name="password" required>
                            <button class="btn btn-outline-secondary" type="button" id="togglePassword">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                        <div class="form-text">vCenter Passwort</div>
                    </div>
                    
                    <div class="mb-4">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="ignore_ssl" name="ignore_ssl">
                            <label class="form-check-label" for="ignore_ssl">
                                SSL-Zertifikatsprüfung ignorieren
                            </label>
                        </div>
                        <div class="form-text ms-4">Aktivieren, wenn Ihr vCenter-Server ein selbstsigniertes oder ungültiges SSL-Zertifikat verwendet</div>
                    </div>
                    
                    <div class="d-grid gap-2">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-plug me-2"></i>Verbinden
                        </button>
                        <a href="{{ url_for('index') }}" class="btn btn-outline-secondary">
                            <i class="fas fa-arrow-left me-2"></i>Zurück
                        </a>
                    </div>
                </form>
            </div>
        </div>
        
        <div class="card mt-4">
            <div class="card-header">
                <h5 class="mb-0">Verbindungshinweise</h5>
            </div>
            <div class="card-body">
                <div class="alert alert-info" role="alert">
                    <h5><i class="fas fa-info-circle me-2"></i>Information zur Datensicherheit</h5>
                    <p class="mb-0">
                        Ihre Anmeldedaten werden nie dauerhaft gespeichert. Sie bleiben nur während Ihrer aktiven Sitzung im Arbeitsspeicher und werden nach dem Beenden der Sitzung gelöscht.
                    </p>
                </div>
                <p><strong>Benötigte Berechtigungen:</strong></p>
                <ul>
                    <li>Lesezugriff auf alle VMs, Hosts, Datastores und Netzwerke</li>
                    <li>Lesezugriff auf Snapshots und Resource Pools</li>
                    <li>Bei Problemen mit dem SSL-Zertifikat aktivieren Sie die Option "SSL-Zertifikatsprüfung ignorieren"</li>
                </ul>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    // Passwort-Sichtbarkeit umschalten
    document.getElementById('togglePassword').addEventListener('click', function() {
        const passwordInput = document.getElementById('password');
        const icon = this.querySelector('i');
        
        if (passwordInput.type === 'password') {
            passwordInput.type = 'text';
            icon.classList.remove('fa-eye');
            icon.classList.add('fa-eye-slash');
        } else {
            passwordInput.type = 'password';
            icon.classList.remove('fa-eye-slash');
            icon.classList.add('fa-eye');
        }
    });
</script>
{% endblock %}