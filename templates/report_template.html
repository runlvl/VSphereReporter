<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ report_title }} | Bechtle VMware vSphere Reporter</title>
    <style>
        {% include 'styles.css' %}
    </style>
    <script>
        // JavaScript für verbesserte Sprungmarken und Navigation
        document.addEventListener('DOMContentLoaded', function() {
            // Aktive Klasse für die Navigation hinzufügen, wenn ein Abschnitt sichtbar ist
            var sections = document.querySelectorAll('.section');
            var navLinks = document.querySelectorAll('.nav-links a');
            
            // Scroll-Handler
            function highlightNav() {
                var scrollPosition = window.scrollY + 60; // Navigationshöhe berücksichtigen
                
                sections.forEach(function(section) {
                    var sectionTop = section.offsetTop;
                    var sectionHeight = section.offsetHeight;
                    var sectionId = section.getAttribute('id');
                    
                    if (scrollPosition >= sectionTop && scrollPosition < sectionTop + sectionHeight) {
                        // Aktive Klasse entfernen
                        navLinks.forEach(function(navLink) {
                            navLink.classList.remove('active');
                        });
                        
                        // Aktive Klasse für den aktuellen Abschnitt hinzufügen
                        var activeLink = document.querySelector('.nav-links a[href="#' + sectionId + '"]');
                        if (activeLink) {
                            activeLink.classList.add('active');
                        }
                    }
                });
            }
            
            // Initial und bei Scroll aktive Navigation setzen
            window.addEventListener('scroll', highlightNav);
            highlightNav();
            
            // Smooth Scroll für Navigations-Links
            navLinks.forEach(function(link) {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    var targetId = this.getAttribute('href');
                    var targetElement = document.querySelector(targetId);
                    
                    if (targetElement) {
                        window.scrollTo({
                            top: targetElement.offsetTop - 60, // Navigationshöhe berücksichtigen
                            behavior: 'smooth'
                        });
                    }
                });
            });

            // Direkte Sprungmarken-Links im Text (für VM Snapshots und VMDK Files)
            document.addEventListener('click', function(e) {
                if (e.target.tagName === 'A' && e.target.getAttribute('href') && e.target.getAttribute('href').startsWith('#')) {
                    e.preventDefault();
                    var targetId = e.target.getAttribute('href');
                    var targetElement = document.querySelector(targetId);
                    
                    if (targetElement) {
                        window.scrollTo({
                            top: targetElement.offsetTop - 60, // Navigationshöhe berücksichtigen
                            behavior: 'smooth'
                        });
                        
                        // Aktive Klasse für den angeklickten Abschnitt setzen
                        navLinks.forEach(function(navLink) {
                            navLink.classList.remove('active');
                        });
                        
                        var activeLink = document.querySelector('.nav-links a[href="' + targetId + '"]');
                        if (activeLink) {
                            activeLink.classList.add('active');
                        }
                    }
                }
            });
        });
    </script>
</head>
<body>
    <!-- Fixed Navigation Bar -->
    <nav class="nav-fixed">
        <!-- Bechtle Logo (small version for nav) -->
        <img src="data:image/png;base64,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" alt="Bechtle Logo" class="nav-logo">
        
        <div class="nav-title">VMware vSphere Reporter</div>
        
        <ul class="nav-links">
            <li><a href="#executive-summary">Summary</a></li>
            {% for section in sections %}
            <li><a href="#{{ section.id }}">{{ section.title }}</a></li>
            {% endfor %}
        </ul>
    </nav>

    <div class="container">
        <!-- Title page -->
        <div class="title-page" id="top">
            <!-- Bechtle Logo (PNG) -->
            <img src="data:image/png;base64,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" alt="Bechtle Logo" class="logo">
            
            <h1 class="title">{{ report_title }}</h1>
            <p class="subtitle">Generated on: {{ report_date|format_datetime }}</p>
        </div>

        <!-- Das ursprüngliche Inhaltsverzeichnis wird entfernt, da die Navigation jetzt über das horizontale Menü erfolgt -->

        <!-- Executive Summary -->
        <div class="section" id="executive-summary">
            <h2>Executive Summary</h2>
            <p>
                This report contains information about the VMware vSphere environment. 
                It includes details about VMware Tools versions, VM snapshots, orphaned VMDK files, 
                and other important aspects of the environment.
            </p>
            
            <h3>Summary Statistics</h3>
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Item</th>
                        <th>Count</th>
                    </tr>
                </thead>
                <tbody>
                    {% if data.vmware_tools %}
                    <tr>
                        <td>VMware Tools versions needing upgrade</td>
                        <td class="center">
                            {{ data.vmware_tools|selectattr('vmware_tools_version', 'equalto', 'guestToolsNeedUpgrade')|list|length }}
                        </td>
                    </tr>
                    {% endif %}
                    
                    {% if data.snapshots %}
                    <tr>
                        <td>VMs with snapshots</td>
                        <td class="center">
                            {{ data.snapshots|map(attribute='vm_name')|unique|list|length }}
                        </td>
                    </tr>
                    {% endif %}
                    
                    {% if data.orphaned_vmdks %}
                    <tr>
                        <td>Orphaned VMDK files</td>
                        <td class="center">{{ data.orphaned_vmdks|length }}</td>
                    </tr>
                    {% endif %}
                    
                    {% if data.vms %}
                    <tr>
                        <td>Total virtual machines</td>
                        <td class="center">{{ data.vms|length }}</td>
                    </tr>
                    {% endif %}
                    
                    {% if data.hosts %}
                    <tr>
                        <td>Total ESXi hosts</td>
                        <td class="center">{{ data.hosts|length }}</td>
                    </tr>
                    {% endif %}
                    
                    {% if data.datastores %}
                    <tr>
                        <td>Total datastores</td>
                        <td class="center">{{ data.datastores|length }}</td>
                    </tr>
                    {% endif %}
                </tbody>
            </table>
        </div>

        <!-- VMware Tools Section -->
        {% if data.vmware_tools %}
        <div class="section" id="vmware_tools">
            <h2>VMware Tools Versions</h2>
            <p>{{ sections|selectattr('id', 'equalto', 'vmware_tools')|map(attribute='description')|first }}</p>
            
            <table class="data-table">
                <thead>
                    <tr>
                        <th>VM Name</th>
                        <th>Power State</th>
                        <th>Tools Status</th>
                        <th>Tools Version</th>
                    </tr>
                </thead>
                <tbody>
                    {% for vm in data.vmware_tools %}
                    <tr {% if vm.vmware_tools_version == 'guestToolsNeedUpgrade' %}class="warning"{% endif %}>
                        <td>{{ vm.name }}</td>
                        <td>{{ vm.power_state }}</td>
                        <td>{{ vm.vmware_tools_status }}</td>
                        <td>{{ vm.vmware_tools_version }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            
            {% set outdated_tools = data.vmware_tools|selectattr('vmware_tools_version', 'equalto', 'guestToolsNeedUpgrade')|list %}
            {% if outdated_tools %}
            <div class="recommendation">
                <strong>Recommendation:</strong> There are {{ outdated_tools|length }} virtual machines with outdated VMware Tools. 
                It is recommended to update VMware Tools to the latest version to ensure optimal performance and compatibility.
            </div>
            {% endif %}
        </div>
        {% endif %}

        <!-- Snapshots Section -->
        {% if data.snapshots %}
        <div class="section" id="snapshots">
            <h2>VM Snapshots</h2>
            <p>{{ sections|selectattr('id', 'equalto', 'snapshots')|map(attribute='description')|first }}</p>
            
            <table class="data-table">
                <thead>
                    <tr>
                        <th>VM Name</th>
                        <th>Snapshot Name</th>
                        <th>Description</th>
                        <th>Create Time</th>
                        <th>Age (Days)</th>
                    </tr>
                </thead>
                <tbody>
                    {% for snapshot in data.snapshots %}
                    <tr {% if snapshot.age_days > 7 %}class="warning"{% endif %}>
                        <td>{{ snapshot.vm_name }}</td>
                        <td>{{ snapshot.name }}</td>
                        <td>{{ snapshot.description }}</td>
                        <td>{{ snapshot.create_time|format_datetime }}</td>
                        <td class="center">{{ snapshot.age_days }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            
            {% set old_snapshots = data.snapshots|selectattr('age_days', 'greaterthan', 7)|list %}
            {% if old_snapshots %}
            <div class="recommendation">
                <strong>Recommendation:</strong> There are {{ old_snapshots|length }} snapshots older than 7 days. 
                It is recommended to consolidate or remove old snapshots to maintain optimal performance.
            </div>
            {% endif %}
        </div>
        {% endif %}

        <!-- Orphaned VMDKs Section -->
        {% if data.orphaned_vmdks %}
        <div class="section" id="orphaned_vmdks">
            <h2>Orphaned VMDK Files</h2>
            <p>{{ sections|selectattr('id', 'equalto', 'orphaned_vmdks')|map(attribute='description')|first }}</p>
            
            {% if data.orphaned_vmdks|length == 0 %}
            <p>No orphaned VMDK files found in the environment.</p>
            {% else %}
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Path</th>
                        <th>Datastore</th>
                        <th>Size</th>
                        <th>Reason</th>
                    </tr>
                </thead>
                <tbody>
                    {% for vmdk in data.orphaned_vmdks %}
                    <tr>
                        <td>{{ vmdk.path }}</td>
                        <td>{{ vmdk.datastore }}</td>
                        <td>{{ vmdk.size|format_size }}</td>
                        <td>{{ vmdk.reason }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            
            {% set total_size = data.orphaned_vmdks|sum(attribute='size') %}
            <div class="recommendation">
                <strong>Recommendation:</strong> There are {{ data.orphaned_vmdks|length }} orphaned VMDK files consuming approximately {{ total_size|format_size }} of storage. 
                It is recommended to verify and remove these files to reclaim storage space.
            </div>
            {% endif %}
        </div>
        {% endif %}

        <!-- VMs Section -->
        {% if data.vms %}
        <div class="section" id="vms">
            <h2>Virtual Machines</h2>
            <p>{{ sections|selectattr('id', 'equalto', 'vms')|map(attribute='description')|first }}</p>
            
            <table class="data-table">
                <thead>
                    <tr>
                        <th>VM Name</th>
                        <th>Power State</th>
                        <th>Guest OS</th>
                        <th>CPU</th>
                        <th>Memory (MB)</th>
                        <th>Used Space</th>
                    </tr>
                </thead>
                <tbody>
                    {% for vm in data.vms %}
                    <tr>
                        <td>{{ vm.name }}</td>
                        <td>{{ vm.power_state }}</td>
                        <td>{{ vm.guest_full_name }}</td>
                        <td class="center">{{ vm.num_cpu }}</td>
                        <td class="center">{{ vm.memory_mb }}</td>
                        <td>{{ vm.used_space|format_size }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% endif %}

        <!-- Hosts Section -->
        {% if data.hosts %}
        <div class="section" id="hosts">
            <h2>ESXi Hosts</h2>
            <p>{{ sections|selectattr('id', 'equalto', 'hosts')|map(attribute='description')|first }}</p>
            
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Host Name</th>
                        <th>Cluster</th>
                        <th>Connection State</th>
                        <th>CPU Model</th>
                        <th>CPU Cores</th>
                        <th>Memory (GB)</th>
                    </tr>
                </thead>
                <tbody>
                    {% for host in data.hosts %}
                    <tr>
                        <td>{{ host.name }}</td>
                        <td>{{ host.cluster }}</td>
                        <td>{{ host.connection_state }}</td>
                        <td>{{ host.cpu_model }}</td>
                        <td class="center">{{ host.cpu_cores }}</td>
                        <td class="center">{{ host.memory_size|round(2) }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% endif %}

        <!-- Datastores Section -->
        {% if data.datastores %}
        <div class="section" id="datastores">
            <h2>Datastores</h2>
            <p>{{ sections|selectattr('id', 'equalto', 'datastores')|map(attribute='description')|first }}</p>
            
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Datastore Name</th>
                        <th>Type</th>
                        <th>Capacity</th>
                        <th>Free Space</th>
                        <th>Usage (%)</th>
                    </tr>
                </thead>
                <tbody>
                    {% for datastore in data.datastores %}
                    <tr {% if datastore.usage_percent > 85 %}class="warning"{% endif %}>
                        <td>{{ datastore.name }}</td>
                        <td>{{ datastore.type }}</td>
                        <td>{{ datastore.capacity|format_size }}</td>
                        <td>{{ datastore.free_space|format_size }}</td>
                        <td class="center">{{ datastore.usage_percent|format_percent }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            
            {% set high_usage = data.datastores|selectattr('usage_percent', 'greaterthan', 85)|list %}
            {% if high_usage %}
            <div class="recommendation">
                <strong>Recommendation:</strong> There are {{ high_usage|length }} datastores with usage above 85%. 
                Consider adding more storage capacity or migrating VMs to balance usage.
            </div>
            {% endif %}
        </div>
        {% endif %}

        <!-- Clusters Section -->
        {% if data.clusters %}
        <div class="section" id="clusters">
            <h2>Clusters</h2>
            <p>{{ sections|selectattr('id', 'equalto', 'clusters')|map(attribute='description')|first }}</p>
            
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Cluster Name</th>
                        <th>Hosts</th>
                        <th>DRS Enabled</th>
                        <th>HA Enabled</th>
                        <th>Total Memory (GB)</th>
                    </tr>
                </thead>
                <tbody>
                    {% for cluster in data.clusters %}
                    <tr>
                        <td>{{ cluster.name }}</td>
                        <td class="center">{{ cluster.hosts }}</td>
                        <td class="center">{{ cluster.drs_enabled }}</td>
                        <td class="center">{{ cluster.ha_enabled }}</td>
                        <td class="center">
                            {% if cluster.total_memory %}
                                {{ (cluster.total_memory / (1024 * 1024 * 1024))|round(2) }}
                            {% else %}
                                0
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% endif %}

        <!-- Resource Pools Section -->
        {% if data.resource_pools %}
        <div class="section" id="resource_pools">
            <h2>Resource Pools</h2>
            <p>{{ sections|selectattr('id', 'equalto', 'resource_pools')|map(attribute='description')|first }}</p>
            
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Resource Pool Name</th>
                        <th>Parent</th>
                        <th>CPU Shares</th>
                        <th>CPU Limit</th>
                        <th>Memory Limit</th>
                    </tr>
                </thead>
                <tbody>
                    {% for pool in data.resource_pools %}
                    <tr>
                        <td>{{ pool.name }}</td>
                        <td>{{ pool.parent_type }}: {{ pool.parent_name }}</td>
                        <td class="center">{{ pool.cpu_shares }}</td>
                        <td class="center">
                            {% if pool.cpu_limit == -1 %}
                                Unlimited
                            {% else %}
                                {{ pool.cpu_limit }}
                            {% endif %}
                        </td>
                        <td class="center">
                            {% if pool.memory_limit == -1 %}
                                Unlimited
                            {% else %}
                                {{ pool.memory_limit }}
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% endif %}

        <!-- Networks Section -->
        {% if data.networks %}
        <div class="section" id="networks">
            <h2>Networks</h2>
            <p>{{ sections|selectattr('id', 'equalto', 'networks')|map(attribute='description')|first }}</p>
            
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Network Name</th>
                        <th>Type</th>
                        <th>Accessible</th>
                        <th>Additional Info</th>
                    </tr>
                </thead>
                <tbody>
                    {% for network in data.networks %}
                    <tr>
                        <td>{{ network.name }}</td>
                        <td>{{ network.type }}</td>
                        <td class="center">{{ network.accessible }}</td>
                        <td>
                            {% if network.type == 'DistributedVirtualPortgroup' %}
                                {% if network.dvs_name is defined and network.vlan_id is defined %}
                                    DVS: {{ network.dvs_name }}, VLAN: {{ network.vlan_id }}
                                {% else %}
                                    Distributed Virtual Portgroup
                                {% endif %}
                            {% else %}
                                Standard Network
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% endif %}

        <!-- Footer with Bechtle branding -->
        <div class="footer">
            <p>Generated by <strong>VMware vSphere Reporter</strong> | A Bechtle AG solution</p>
            <p>© {{ report_date.year }} Bechtle AG. All rights reserved.</p>
        </div>
    </div>
    
    <!-- Back to top button -->
    <a href="#top" class="back-to-top" id="backToTop">↑</a>
    
    <!-- JavaScript for navigation and fixed elements -->
    <script>
        // Back to top button visibility
        window.addEventListener('scroll', function() {
            var backToTopButton = document.getElementById('backToTop');
            if (window.pageYOffset > 300) {
                backToTopButton.classList.add('visible');
            } else {
                backToTopButton.classList.remove('visible');
            }
        });
        
        // Highlight active menu item based on scroll position
        window.addEventListener('scroll', function() {
            // Get all sections
            var sections = document.querySelectorAll('.section');
            var navLinks = document.querySelectorAll('.nav-links a');
            
            // Determine current scroll position
            var currentPos = window.pageYOffset;
            
            // Find the current section
            sections.forEach(function(section) {
                var sectionTop = section.offsetTop - 100; // Account for nav height
                var sectionBottom = sectionTop + section.offsetHeight;
                
                if (currentPos >= sectionTop && currentPos < sectionBottom) {
                    // Remove active class from all links
                    navLinks.forEach(function(link) {
                        link.classList.remove('active');
                    });
                    
                    // Add active class to corresponding nav link
                    var id = section.getAttribute('id');
                    var correspondingLink = document.querySelector('.nav-links a[href="#' + id + '"]');
                    if (correspondingLink) {
                        correspondingLink.classList.add('active');
                    }
                }
            });
        });
        
        // Smooth scroll to sections when clicking navigation links
        document.querySelectorAll('.nav-links a, .toc a, .back-to-top').forEach(function(anchor) {
            anchor.addEventListener('click', function(e) {
                e.preventDefault();
                
                var targetId = this.getAttribute('href');
                var targetElement = document.querySelector(targetId);
                
                if (targetElement) {
                    window.scrollTo({
                        top: targetElement.offsetTop - 60,
                        behavior: 'smooth'
                    });
                }
            });
        });
    </script>
</body>
</html>
